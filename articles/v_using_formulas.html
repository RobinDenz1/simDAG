<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Specifying Formulas in a DAG • simDAG</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specifying Formulas in a DAG">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">simDAG</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v_covid_example.html">Simulating Covid-19 Vaccine Data using a Discrete-Time Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/v_sim_discrete_time.html">Simulating Data using a Discrete-Time Approach</a></li>
    <li><a class="dropdown-item" href="../articles/v_sim_from_dag.html">Simulating Data from a known DAG</a></li>
    <li><a class="dropdown-item" href="../articles/v_using_formulas.html">Specifying Formulas in a DAG</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinDenz1/siMDAG/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Specifying Formulas in a DAG</h1>
                        <h4 data-toc-skip class="author">Robin Denz</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RobinDenz1/siMDAG/blob/main/vignettes/v_using_formulas.Rmd" class="external-link"><code>vignettes/v_using_formulas.Rmd</code></a></small>
      <div class="d-none name"><code>v_using_formulas.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this small vignette, we give more detailed examples on how best to
use the <code>formula</code> argument in the <code><a href="../reference/node.html">node()</a></code> and
<code><a href="../reference/node.html">node_td()</a></code> functions. This argument allows users to directly
specify the full structural equation that should be used to generate the
respective node in a clear and easy way, that does not directly rely on
the <code>parents</code>, <code>betas</code> and associated arguments.
Note that the <code>formula</code> argument may only be used with
certain node types, as mentioned in the documentation.</p>
</div>
<div class="section level2">
<h2 id="a-simple-example">A simple example<a class="anchor" aria-label="anchor" href="#a-simple-example"></a>
</h2>
<p>We will start with a very simple example. Suppose we want to generate
some data from a simple DAG with no time-varying variables. Consider the
following DAG:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RobinDenz1/simDAG" class="external-link">simDAG</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/empty_dag.html">empty_dag</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"A"</span>, type<span class="op">=</span><span class="st">"rnorm"</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"B"</span>, type<span class="op">=</span><span class="st">"rbernoulli"</span>, p<span class="op">=</span><span class="fl">0.5</span>, output<span class="op">=</span><span class="st">"numeric"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"C"</span>, type<span class="op">=</span><span class="st">"rcategorical"</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>       output<span class="op">=</span><span class="st">"factor"</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This DAG contains only three root nodes of different types.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
is normally distributed,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is Bernoulli distributed and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
is a simple categorical variable with the levels “low”, “medium” and
“high”. If we generate data from this DAG alone, it would look like
this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">23143</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_from_DAG.html">sim_from_dag</a></span><span class="op">(</span><span class="va">dag</span>, n_sim<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;             A     B      C</span></span>
<span><span class="co">#&gt;         &lt;num&gt; &lt;num&gt; &lt;fctr&gt;</span></span>
<span><span class="co">#&gt; 1: -0.8041685     0    low</span></span>
<span><span class="co">#&gt; 2:  1.3390885     0 medium</span></span>
<span><span class="co">#&gt; 3:  0.9455804     0   high</span></span>
<span><span class="co">#&gt; 4: -2.3437852     1    low</span></span>
<span><span class="co">#&gt; 5: -0.9045554     1 medium</span></span>
<span><span class="co">#&gt; 6:  0.8532361     1 medium</span></span></code></pre></div>
<p>Suppose we now want to generate an additional child node called
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
which should be based on a linear regression model of the form:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>∼</mo><mo>−</mo><mn>8</mn><mo>+</mo><mi>A</mi><mo>⋅</mo><mn>0.4</mn><mo>+</mo><mi>B</mi><mo>⋅</mo><mo>−</mo><mn>2</mn><mo>+</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">D \sim -8 + A \cdot 0.4 + B \cdot -2 + N(0, 1.5).</annotation></semantics></math></p>
<p>We could do this using the <code><a href="../reference/node.html">node()</a></code> function, by supplying
appropriate values to the <code>parents</code>, <code>betas</code>,
<code>intercept</code> and <code>error</code> arguments. The following
code could be used:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag_without_formula</span> <span class="op">&lt;-</span> <span class="va">dag</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"D"</span>, type<span class="op">=</span><span class="st">"gaussian"</span>, parents<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, betas<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>       intercept<span class="op">=</span><span class="op">-</span><span class="fl">8</span>, error<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p>This does work just fine, but it may be a little cumbersome to
specify the DAG in this way. Since we want to use a linear regression
model, we could instead use the <code>formula</code> argument like
this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag_with_formula</span> <span class="op">&lt;-</span> <span class="va">dag</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"D"</span>, type<span class="op">=</span><span class="st">"gaussian"</span>, formula<span class="op">=</span> <span class="op">~</span> <span class="op">-</span><span class="fl">8</span> <span class="op">+</span> <span class="va">A</span><span class="op">*</span><span class="fl">0.4</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="op">-</span><span class="fl">2</span>, error<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p>Given the same random number generator seed, the same output will be
produced from both DAGs, as shown below:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">34</span><span class="op">)</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_from_DAG.html">sim_from_dag</a></span><span class="op">(</span><span class="va">dag_without_formula</span>, n_sim<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">34</span><span class="op">)</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_from_DAG.html">sim_from_dag</a></span><span class="op">(</span><span class="va">dag_with_formula</span>, n_sim<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Formulas should always start with a <code>~</code> sign and have
nothing else on the left hand side. All parts of the formula should be
connected by <code>+</code> signs, never <code>-</code> signs. The name
of the respective variable should always be connected to the associated
coefficient by a <code>*</code> sign. It does not matter whether the
name of the term or the coefficient go first, but it has to be
consistent in a formula. For example, <code>~ 1 + A*2 + B*3</code>
works, and <code>~ 1 + 2*A + 3*B</code> also works, but
<code>~ 1 + 2*A + B*2</code> will produce an error. The formula may also
be supplied as a string and will produce the same output.</p>
<p>Apart from being easier to read, this also allows the user a lot more
options. Through the use of formulas it is possible to specify nodes
that have categorical parents. It is also possible to include any order
of interaction effects and cubic terms using formulas, as shown
below.</p>
</div>
<div class="section level2">
<h2 id="using-a-categorical-parent-variable">Using a Categorical Parent Variable<a class="anchor" aria-label="anchor" href="#using-a-categorical-parent-variable"></a>
</h2>
<p>Suppose that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
should additionally depend on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>,
a categorical variable. For example, suppose this is the regression
model we want to generate data from:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>∼</mo><mo>−</mo><mn>8</mn><mo>+</mo><mi>A</mi><mo>⋅</mo><mn>0.4</mn><mo>+</mo><mi>B</mi><mo>⋅</mo><mo>−</mo><mn>2</mn><mo>+</mo><mi>C</mi><mi>m</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>u</mi><mi>m</mi><mo>⋅</mo><mo>−</mo><mn>1</mn><mo>+</mo><mi>C</mi><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi><mo>⋅</mo><mo>−</mo><mn>3</mn><mo>+</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">D \sim -8 + A \cdot 0.4 + B \cdot -2 + Cmedium \cdot -1 + Chigh \cdot -3 + N(0, 1.5).</annotation></semantics></math></p>
<p>In this model, the “low” category is used as a reference category. If
this is what we want to do, using the simple <code>parents</code>,
<code>betas</code>, <code>intercept</code> approach no longer works. We
have to use a formula. Fortunately, this is really simple to do using
the following code:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag2</span> <span class="op">&lt;-</span> <span class="va">dag</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"D"</span>, type<span class="op">=</span><span class="st">"gaussian"</span>, error<span class="op">=</span><span class="fl">1.5</span>,</span>
<span>       formula<span class="op">=</span><span class="op">~</span> <span class="op">-</span><span class="fl">8</span> <span class="op">+</span> <span class="va">A</span><span class="op">*</span><span class="fl">0.4</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="op">-</span><span class="fl">2</span> <span class="op">+</span> <span class="va">Cmedium</span><span class="op">*</span><span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Chigh</span><span class="op">*</span><span class="op">-</span><span class="fl">3</span>,</span>
<span>       parents<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Essentially, all we have to do is use the name of the categorical
variable immediately followed by the category name. Note that if a
different reference category should be used, the user needs to re-define
the factor levels of the categorical variable accordingly first.</p>
<p>Note that we also defined the <code>parents</code> argument in this
case. This is not strictly necessary to generate the data in this case,
but it is recommended whenever categorical variables are used in a
<code>formula</code> for two reasons:</p>
<ul>
<li>
<strong>1.)</strong> If <code>parents</code> is not specified, the
<code><a href="../reference/sim_from_DAG.html">sim_from_dag()</a></code> function will not know that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
is a parent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>.
If <code>sort_dag=TRUE</code> and/or the nodes are not specified in a
correctly topologically sorted order, this may lead to errors when
trying to generate the data.</li>
<li>
<strong>2.)</strong> If <code>parents</code> is not specified, other
functions that take DAG objects as input (such as the
<code><a href="../reference/plot.DAG.html">plot.DAG()</a></code> function) may produce incorrect output, because
they won’t know that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
is a parent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="using-interaction-effects">Using Interaction Effects<a class="anchor" aria-label="anchor" href="#using-interaction-effects"></a>
</h2>
<p>Interactions of any sort may also be added to the DAG. Suppose we
want to generate data from the following regression model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>∼</mo><mo>−</mo><mn>8</mn><mo>+</mo><mi>A</mi><mo>⋅</mo><mn>0.4</mn><mo>+</mo><mi>B</mi><mo>⋅</mo><mo>−</mo><mn>2</mn><mo>+</mo><mi>A</mi><mo>*</mo><mi>B</mi><mo>⋅</mo><mo>−</mo><mn>5</mn><mo>+</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">D \sim -8 + A \cdot 0.4 + B \cdot -2 + A*B \cdot -5 + N(0, 1.5),</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>*</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A*B</annotation></semantics></math>
indicates the interaction between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>.
This can be specified in the <code>formula</code> argument using the
<code>:</code> sign:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag3</span> <span class="op">&lt;-</span> <span class="va">dag</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"D"</span>, type<span class="op">=</span><span class="st">"gaussian"</span>, formula<span class="op">=</span> <span class="op">~</span> <span class="op">-</span><span class="fl">8</span> <span class="op">+</span> <span class="va">A</span><span class="op">*</span><span class="fl">0.4</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="op">-</span><span class="fl">2</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">B</span><span class="op">*</span><span class="op">-</span><span class="fl">5</span>, error<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p>Since both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
are coded as numeric variables here, this works fine. If we instead want
to include an interaction which includes a categorical variable, we
again have to use the name with the respective category appended to it.
For example, the following DAG includes an interaction between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag4</span> <span class="op">&lt;-</span> <span class="va">dag</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"D"</span>, type<span class="op">=</span><span class="st">"gaussian"</span>, error<span class="op">=</span><span class="fl">1.5</span>,</span>
<span>       formula<span class="op">=</span><span class="op">~</span> <span class="op">-</span><span class="fl">8</span> <span class="op">+</span> <span class="va">A</span><span class="op">*</span><span class="fl">0.4</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="op">-</span><span class="fl">2</span> <span class="op">+</span> <span class="va">Cmedium</span><span class="op">*</span><span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Chigh</span><span class="op">*</span><span class="op">-</span><span class="fl">3</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">Cmedium</span><span class="op">*</span><span class="fl">0.3</span> <span class="op">+</span> </span>
<span>         <span class="va">A</span><span class="op">:</span><span class="va">Chigh</span><span class="op">*</span><span class="fl">10</span>,</span>
<span>       parents<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Higher order interactions may be specified in exactly the same way,
just using more <code>:</code> symbols. It may not always be obvious in
which order the variables for the interaction need to be specified. If
the “wrong” order was used, the <code><a href="../reference/sim_from_DAG.html">sim_from_dag()</a></code> function
will return a helpful error message explaining which ones should be used
instead. For example, if we had used “Cmedium:A” instead of “A:Cmedium”,
this would not work because internally only the latter is recognized as
a valid column. Note that because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
is categorical, we also specified the <code>parents</code> argument here
just to be safe.</p>
</div>
<div class="section level2">
<h2 id="using-cubic-terms">Using Cubic Terms<a class="anchor" aria-label="anchor" href="#using-cubic-terms"></a>
</h2>
<p>Sometimes we also want to include non-linear relationships between a
continuous variable and the outcome in a data generation process. This
can be done by including cubic terms of that variable in a formula.
Suppose the regression model that we want to use has the following
form:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>∼</mo><mo>−</mo><mn>8</mn><mo>+</mo><mi>A</mi><mo>⋅</mo><mn>0.4</mn><mo>+</mo><msup><mi>A</mi><mn>2</mn></msup><mo>⋅</mo><mn>0.02</mn><mo>+</mo><mi>B</mi><mo>⋅</mo><mo>−</mo><mn>2</mn><mo>+</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">D \sim -8 + A \cdot 0.4 + A^2 \cdot 0.02 + B \cdot -2 + N(0, 1.5).</annotation></semantics></math></p>
<p>The following code may be used to define such as node:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag_with_formula</span> <span class="op">&lt;-</span> <span class="va">dag</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"D"</span>, type<span class="op">=</span><span class="st">"gaussian"</span>, formula<span class="op">=</span> <span class="op">~</span> <span class="op">-</span><span class="fl">8</span> <span class="op">+</span> <span class="va">A</span><span class="op">*</span><span class="fl">0.4</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">A</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">0.02</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="op">-</span><span class="fl">2</span>,</span>
<span>       error<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p>Users may of course use as many cubic terms as they like.</p>
</div>
<div class="section level2">
<h2 id="using-functions-in-formula">Using Functions in formula<a class="anchor" aria-label="anchor" href="#using-functions-in-formula"></a>
</h2>
<p>There is also limited support for including functions in the formula
as well. For example, it is allowed to call any function on the beta
coefficients, which is useful to specify betas on a different scale (for
example using Odds-Ratios instead of betas). For example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dag_with_fun</span> <span class="op">&lt;-</span> <span class="va">dag</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="st">"D"</span>, type<span class="op">=</span><span class="st">"binomial"</span>, formula<span class="op">=</span> <span class="op">~</span> <span class="op">-</span><span class="fl">3</span> <span class="op">+</span> <span class="va">A</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p>is valid syntax. Any function can be used in the place of
<code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log()</a></code>, as long as it is a single function that is called on
a beta-coefficient.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin Denz, Katharina Meiszl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
